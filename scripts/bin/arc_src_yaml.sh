#!/usr/bin/env bash 

# grep -i "^type:" *.yaml | awk -F'[ :]' '{print "["$NF"]="$NF}' | sort -u | paste -d' ' -s -

declare -A ARC_TYPE=([AURORA_POSTGRESQL]=AURORA_POSTGRESQL [AWS_KEYSPACES]=AWS_KEYSPACES [BIGQUERY]=BIGQUERY [CASSANDRA]=CASSANDRA [COCKROACH]=COCKROACH [COSMOSDB]=COSMOSDB [CSV]=CSV [DATABRICKS_DELTALAKE]=DATABRICKS_DELTALAKE [DATABRICKS_LAKEHOUSE]=DATABRICKS_LAKEHOUSE [DB2]=DB2 [FTP]=FTP [GREENPLUM]=GREENPLUM [HANA]=HANA [HIVE]=HIVE [IMPLY]=IMPLY [INFORMIX]=INFORMIX [KAFKA]=KAFKA [LOCALSTORAGE]=LOCALSTORAGE [LOCAL]=LOCAL [MARIADB]=MARIADB [MATERIALIZE]=MATERIALIZE [MEMSQL]=MEMSQL [MONGODBATLAS]=MONGODBATLAS [MONGODB]=MONGODB [MYSQL]=MYSQL [NETEZZA]=NETEZZA [ORACLE]=ORACLE [PINGCAP]=PINGCAP [POSTGRESQL]=POSTGRESQL [REDIS_STREAM]=REDIS_STREAM [REDSHIFT]=REDSHIFT [REPLICATE_STAGE]=REPLICATE_STAGE [S3]=S3 [SALESFORCE]=SALESFORCE [SAP_IQ]=SAP_IQ [SFTP]=SFTP [SINGLESTORE]=SINGLESTORE [SKYSQL]=SKYSQL [SNOWFLAKE]=SNOWFLAKE [SPARK]=SPARK [SQLITE]=SQLITE [SQLSERVER]=SQLSERVER [SYBASE_ASE]=SYBASE_ASE [TERADATA]=TERADATA [TRAFODION]=TRAFODION [VERTICA]=VERTICA [XA]=XA [YUGABYTESQL]=YUGABYTESQL [YUGABYTE_CQL]=YUGABYTE_CQL)


. ../lib/urlparse.sh

scheme=$( urlparse_scheme $@ )
scheme=${ARC_TYPE[${scheme^^}]} # lookup from a valid list